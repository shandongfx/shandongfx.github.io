<!DOCTYPE html>
	<html>
		<head>
			<title>Using a network-diagram to facilitate eliminating predictor variables</title>
			<!-- link to main stylesheet -->
			<link rel="stylesheet" type="text/css" href="/css/main.css">
		</head>
		<body>
			<nav>
	    		<ul>
	        		<li><a href="/">Home</a></li>
					<li><a href="/publication">Publication</a></li>
	        		<li><a href="/blog/">Research note</a></li>
					<li><a href="/teaching/">Teaching</a></li>
					

	    		</ul>
			</nav>
			<div class="container">
			
			<h1>Using a network-diagram to facilitate eliminating predictor variables</h1>
<p class="meta">01 Jan 2015</p>

<div class="post">
  <p>In ecological niche modelling, we always faced the problem of variable 
selection and colinearity (Dormann et al. 2013). Because highly correlated predictor variables may lead to model overfitting, so we introduced a method to facilitate eliminating predictor variables when the aim is to avoid colinearity (see more details in our paper Feng et al. 2015). We used network-diagram which is straight forward in showing the complex colinearity structure of all predictor variables.</p>

<p>The general steps:</p>
<ul>
  <li>
    <p>(1) Build a Pearson correlation matrix for the all predictor variables with raster library in R (Hijmans 2014). Here we used 19 bioclimatic variables as an example (worldclim.org).</p>
  </li>
  <li>
    <p>(2) Draw a network diagram using igraph library in R (Csardi and Nepusz 2006). In the network diagram, highly correlated (|r|&gt;0.7) variables are linked by lines, and the group of variables with colinearity would clustere together (Figure 1).</p>
  </li>
  <li>
    <p>(3) With this network diagram, there are multiply ways to select variables depending on your needs. One way is to pick one variable out of a group of clusted variables; another way is to choose a starting node and jumping across a nod to select a second node. However, the variable selection should be ecologically justified. For example, we prioritized extreme variables instead of average variables among the clustered variables (e.g., we selected maximum temperature of the warmest month instead of annual mean temperature), assuming that extreme variables are more likely to be limiting factors for the species.</p>
  </li>
</ul>

<p><img src="/figure/old_post/fig.1.jpg" alt="network1" style="width: 300px;" align="middle" /></p>

<p><em>Figure 1. Network diagram of 19 bioclimatic variables. The yellow circles represent temperature variables and the green circles represent precipitation variables. Two circles are linked if the two represented variables have a high correlation (|r|â‰¥ 0.7). The selected variables are marked with red boundaries.</em></p>

<p>*The network diagram is implemented in R, with raster and igraph libraries.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1">#include igraph and raster libraries
</span><span class="n">library</span><span class="p">(</span><span class="n">igraph</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">raster</span><span class="p">)</span><span class="w">

</span><span class="c1">#load predictor variables
#bioFiles &lt;- list.files(path = "path for variable", pattern = ".asc$", recursive = FALSE, full.names=TRUE)
</span><span class="n">bioFiles</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">list.files</span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"D:/projects/2012.IOZ.pheasant/2012.11-ioz-modify/9.rejected/layer4/prjArea_china_10m_asc/"</span><span class="p">,</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">".asc$"</span><span class="p">,</span><span class="w"> </span><span class="n">recursive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">full.names</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">bioRaster</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stack</span><span class="p">(</span><span class="n">bioFiles</span><span class="p">)</span><span class="w">

</span><span class="c1">#Build correlation matrix
</span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">layerStats</span><span class="p">(</span><span class="n">bioRaster</span><span class="p">,</span><span class="s1">'pearson'</span><span class="p">,</span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)[[</span><span class="m">1</span><span class="p">]]</span><span class="w">

</span><span class="c1">#Set threshold for "high" correlation, here we used 0.7
</span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w">
</span><span class="n">m</span><span class="p">[</span><span class="n">m</span><span class="o">&lt;</span><span class="m">0.7</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">

</span><span class="c1">#
#m&lt;-m*10
</span><span class="w">
</span><span class="c1"># Link variables
</span><span class="n">net</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">graph.adjacency</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s2">"undirected"</span><span class="p">,</span><span class="n">weighted</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="n">diag</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">

</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">11</span><span class="p">){</span><span class="w">
    </span><span class="n">tt</span><span class="o">&lt;-</span><span class="n">paste</span><span class="p">(</span><span class="s2">"bio"</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span><span class="w">
	</span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">net</span><span class="p">)</span><span class="o">$</span><span class="n">name</span><span class="p">)){</span><span class="w">
		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="n">net</span><span class="p">)</span><span class="o">$</span><span class="n">name</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="n">tt</span><span class="p">){</span><span class="w">
			</span><span class="c1"># set up color for the first 11 variables
</span><span class="w">			</span><span class="n">V</span><span class="p">(</span><span class="n">net</span><span class="p">)</span><span class="o">$</span><span class="n">color</span><span class="p">[[</span><span class="n">j</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"yellow"</span><span class="w">
			</span><span class="c1"># set up node size for the first 11 variables
</span><span class="w">			</span><span class="n">V</span><span class="p">(</span><span class="n">net</span><span class="p">)</span><span class="o">$</span><span class="n">size</span><span class="p">[[</span><span class="n">j</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">18</span><span class="w">
			</span><span class="k">break</span><span class="w">
			</span><span class="p">}</span><span class="w">
	</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">12</span><span class="o">:</span><span class="m">19</span><span class="p">){</span><span class="w">
    </span><span class="n">tt</span><span class="o">&lt;-</span><span class="n">paste</span><span class="p">(</span><span class="s2">"bio"</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span><span class="w">
	</span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">net</span><span class="p">)</span><span class="o">$</span><span class="n">name</span><span class="p">)){</span><span class="w">
		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="n">net</span><span class="p">)</span><span class="o">$</span><span class="n">name</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="n">tt</span><span class="p">){</span><span class="w">
			</span><span class="n">V</span><span class="p">(</span><span class="n">net</span><span class="p">)</span><span class="o">$</span><span class="n">color</span><span class="p">[[</span><span class="n">j</span><span class="p">]]</span><span class="o">&lt;-</span><span class="s2">"green"</span><span class="w">
			</span><span class="n">V</span><span class="p">(</span><span class="n">net</span><span class="p">)</span><span class="o">$</span><span class="n">size</span><span class="p">[[</span><span class="n">j</span><span class="p">]]</span><span class="o">&lt;</span><span class="m">-18</span><span class="w">
		</span><span class="p">}</span><span class="w">
	</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="c1"># Draw the network diagram
</span><span class="n">tkplot</span><span class="p">(</span><span class="n">net</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<h2 id="references">References:</h2>
<ul>
  <li>Csardi G, Nepusz T (2006) The igraph software package for complex network research. InterJournal Complex Systems:1695</li>
  <li>Dormann CF, Elith J, Bacher S, Buchmann Cand others (2013) Collinearity: a review of methods to deal with it and a simulation study evaluating their performance. Ecography 36:27-46</li>
  <li>Feng, X., C. Lin, H. Qiao, and L. Ji. Assessment of Climatically Suitable Area for Syrmaticus reevesii under Climate Change. Endangered Species Research 28:19-31. doi:10.3354/esr00668</li>
  <li>Hijmans RJ (2014) Raster: geographic data analysis and modeling.cran.r-project.org/web/packages/raster/ (accessed 1 Nov 2014)</li>
</ul>

</div>

			
			</div><!-- /.container -->
			<footer>
<h5> Copyright 2015-2016 by Xiao Feng </h5>
			</footer>
			<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-86239714-1', 'auto');
  ga('send', 'pageview');

</script>

		</body>
	</html>
